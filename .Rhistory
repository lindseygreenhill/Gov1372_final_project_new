library(readxl)
library(janitor)
library(skimr)
library(rtweet)
library(caTools)
library(tidyverse)
set.seed(1121)
load("data_collection/tweets_1.RData")
load("data_collection/tweets_2.RData")
load("data_collection/tweets_3.RData")
load("data_collection/tweets_4.RData")
load("data_collection/tweets_5.RData")
load("data_collection/tweets_6.RData")
load("data_collection/tweets_7.RData")
load("data_collection/tweets_8.RData")
load("data_collection/tweets_9.RData")
load("data_collection/tweets_10.RData")
load("data_collection/tweets_11.RData")
tweets_full <- Tweets_1 %>%
rbind(Tweets_2) %>%
rbind(Tweets_3) %>%
rbind(Tweets_4) %>%
rbind(Tweets_5) %>%
rbind(Tweets_6) %>%
rbind(Tweets_7) %>%
rbind(Tweets_8) %>%
rbind(Tweets_9) %>%
rbind(Tweets_10) %>%
rbind(Tweets_11)
tweets_tidy <- tweets_full %>%
select(created_at, screen_name, text, is_retweet, hashtags) %>%
filter(is_retweet == FALSE) %>%
mutate(date = ymd(str_sub(created_at, 1, 10))) %>%
filter(date >= as.Date("2020-11-03"))
library(lubridate)
tweets_tidy <- tweets_full %>%
select(created_at, screen_name, text, is_retweet, hashtags) %>%
filter(is_retweet == FALSE) %>%
mutate(date = ymd(str_sub(created_at, 1, 10))) %>%
filter(date >= as.Date("2020-11-03"))
save(tweets_tidy, file = "tweets_complete.RData")
save(tweets_tidy, file = "data_collection/tweets_complete.RData")
smp_size <- floor(.75*nrow(tweets_tidy))
train_ind <- sample(seq_len(nrow(tweets_tidy)), size = smp_size)
training_data <- tweets_tidy[train_ind, ]
testing_data <- tweets_tidy[-train_ind, ]
save(training_data, file = "data_collection/tweets_training_data.RData")
save(testing_data, file = "data_collection/tweets_testing_data.RData")
knitr::opts_chunk$set(echo = TRUE)
library(quanteda)
library(skimr)
library(lubridate)
library(ggthemes)
library(tidyverse)
load("data_collection/tweets_training_data.RData")
knitr::opts_chunk$set(echo = TRUE)
library(quanteda)
library(skimr)
library(lubridate)
library(ggthemes)
library(tidyverse)
load("data_collection/tweets_training_data.RData")
dic_data %>%
group_by(date) %>%
count() %>%
ggplot(aes(x = date, y = n)) +
geom_point() +
theme_clean()
training_data %>%
group_by(date) %>%
count() %>%
ggplot(aes(x = date, y = n)) +
geom_point() +
theme_clean()
glimpse(training_data)
library(readxl)
library(janitor)
library(skimr)
library(rtweet)
library(tidyverse)
twitter_handles_senate <- read_excel("data/congress_twitter_092721.xlsx",
sheet = 1,
skip = 1) %>%
clean_names() %>%
mutate(member = "senate")
twitter_handles_senate <- read_excel("data_collection/data/congress_twitter_092721.xlsx",
sheet = 1,
skip = 1) %>%
clean_names() %>%
mutate(member = "senate")
twitter_handles_house <- read_excel("data_collection/data/congress_twitter_092721.xlsx",
sheet = 2,
skip = 1) %>%
clean_names() %>%
mutate(member = "house")
twitter_handles <- twitter_handles_house %>%
rbind(twitter_handles_senate) %>%
mutate(handle = str_sub(link, start = 21)) %>%
select(-link)
glimpse(twitter_handles)
save(twitter_handles, file = "data_collection/twitter_handles.RData")
load("data_collection/twitter_handles.RData")
glimpse(twitter_handles)
glimpse(training_data)
?left_join
knitr::opts_chunk$set(echo = TRUE)
library(quanteda)
library(skimr)
library(lubridate)
library(ggthemes)
library(tidyverse)
load("data_collection/tweets_training_data.RData")
load("data_collection/twitter_handles.RData")
joined_data <- training_data %>%
left_join(twitter_handles, by = c("screen_name" = "handle"))
joined_data
glimpse(joined_data)
time_plot <- training_data %>%
group_by(date) %>%
count() %>%
ggplot(aes(x = date, y = n)) +
geom_point() +
theme_clean() +
labs(title = "Daily Number of Tweets",
x = "Date",
y = "")
joined_data %>%
group_by(party) %>%
n()
joined_data %>%
group_by(party) %>%
count()
joined_data %>%
group_by(party) %>%
drop_na() %>%
count()
joined_data %>%
group_by(party) %>%
drop_na() %>%
count() %>%
ggplot(aes(x = party, y = n)) +
geom_col() +
theme_clean()
joined_data %>%
group_by(party) %>%
drop_na() %>%
count() %>%
ggplot(aes(x = party, y = n)) +
geom_col(fill = party) +
theme_clean()
joined_data %>%
group_by(party) %>%
drop_na() %>%
count() %>%
ggplot(aes(x = party, y = n)) +
geom_col(aes(fill = party)) +
theme_clean()
joined_data %>%
group_by(party) %>%
drop_na() %>%
count() %>%
ggplot(aes(x = party, y = n)) +
geom_col(aes(fill = party)) +
scale_fill_manual(values = c("darkblue", "green", "red")) +
theme_clean()
party_count_plot <- joined_data %>%
group_by(party) %>%
drop_na() %>%
count() %>%
ggplot(aes(x = party, y = n)) +
geom_col(aes(fill = party)) +
scale_fill_manual(values = c("darkblue", "green", "red")) +
labs(title = "Total Tweets by Party",
"Democrats tweet the most",
x = "Party",
y = "") +
theme_clean()
party_count_plot
ggsave(time_plot, "plots/time_summary_plot.png")
time_plot <- training_data %>%
group_by(date) %>%
count() %>%
ggplot(aes(x = date, y = n)) +
geom_point() +
theme_clean() +
labs(title = "Daily Number of Tweets",
x = "Date",
y = "")
ggsave(time_plot, "plots/time_summary_plot.png")
?ggsave
ggsave(plot = time_plot,"plots/time_summary_plot.png")
party_count_plot <- joined_data %>%
group_by(party) %>%
drop_na() %>%
count() %>%
ggplot(aes(x = party, y = n)) +
geom_col(aes(fill = party)) +
scale_fill_manual(values = c("darkblue", "green", "red")) +
labs(title = "Total Tweets by Party",
"Democrats tweet the most",
x = "Party",
y = "") +
theme_clean()
ggsave(plot = party_count_plot, "plots/party_summary_plot.png")
glimpse(joined_dat)
glimpse(joined_data)
joined_data %>%
group_by(name) %>%
count()
joined_data %>%
group_by(name) %>%
count() %>%
arrange(desc(n))
?slice
name_top <- joined_data %>%
group_by(name) %>%
count() %>%
arrange(desc(n)) %>%
slice(10)
name_top
name_top <- joined_data %>%
group_by(name) %>%
count() %>%
arrange(desc(n)) %>%
slice(10)
name_top <- joined_data %>%
group_by(name) %>%
count() %>%
arrange(desc(n)) %>%
slice(1:10)
name_top
joined_data %>%
group_by(name) %>%
count() %>%
arrange(desc(n)) %>%
slice(1:10)
joined_data %>%
group_by(name) %>%
count() %>%
arrange(desc(n))
joined_data %>%
group_by(name) %>%
count() %>%
arrange(desc(n)) %>%
head()
?head
joined_data %>%
group_by(name) %>%
count() %>%
arrange(desc(n)) %>%
head(10)
name_top <- joined_data %>%
group_by(name) %>%
count() %>%
arrange(desc(n)) %>%
head(10)
name_bottom <- joined_data %>%
group_by(name) %>%
count() %>%
arrange(n) %>%
head(10)
name_bottom
name_top <- joined_data %>%
group_by(name, party) %>%
count() %>%
arrange(desc(n)) %>%
head(10)
name_bottom <- joined_data %>%
group_by(name, party) %>%
count() %>%
arrange(n) %>%
head(10)
name_tweets <- name_top %>%
rbind(name_bottom)
name_tweets
name_tweets_plot <- name_top %>%
rbind(name_bottom) %>%
ggplot(aes(x = name, y = n)) +
geom_col(fill = party) +
coord_flip() +
theme_clean()
name_bottom
name_top %>%
rbind(name_bottom)
name_tweets_plot <- name_top %>%
rbind(name_bottom) %>%
ggplot(aes(x = name, y = n)) +
geom_col(aes(fill = party)) +
coord_flip() +
theme_clean()
name_tweets_plot
name_tweets_plot <- name_top %>%
rbind(name_bottom) %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = name, y = n)) +
geom_col(aes(fill = party)) +
coord_flip() +
theme_clean()
name_tweets_plot
name_top %>%
rbind(name_bottom) %>%
arrange(desc(n))
name_top %>%
rbind(name_bottom) %>%
arrange(desc(n)) %>%
drop_na()
name_tweets_plot <- name_top %>%
rbind(name_bottom) %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = name, y = n)) +
geom_col(aes(fill = party)) +
theme_clean()
name_tweets_plot
name_top <- joined_data %>%
group_by(name, party) %>%
count() %>%
arrange(desc(n)) %>%
head(20)
name_tweets_plot <- name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = name, y = n)) +
geom_col(aes(fill = party)) +
theme_clean()
name_tweets_plot
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = name, y = n)) +
geom_col(aes(fill = party), stat = "identity") +
theme_clean()
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = name, y = n)) +
geom_col(stat = "identity") +
theme_clean()
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, n), y = n)) +
geom_col(stat = "identity") +
theme_clean()
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, -n), y = n)) +
geom_col(stat = "identity") +
theme_clean()
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, -n), y = n)) +
geom_col() +
coord_flip() +
theme_clean()
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, n), y = n)) +
geom_col() +
coord_flip() +
theme_clean()
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, n), y = n)) +
geom_col(fill = party) +
coord_flip() +
theme_clean()
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, n), y = n)) +
geom_col(aes(fill = party)) +
coord_flip() +
theme_clean()
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, n), y = n)) +
geom_col(aes(fill = party)) +
scale_fill_manual(values = c("navyblue", "red")) +
coord_flip() +
theme_clean()
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, n), y = n)) +
geom_col(aes(fill = party)) +
scale_fill_manual(values = c("navyblue", "indianred")) +
coord_flip() +
theme_clean()
party_count_plot <- joined_data %>%
group_by(party) %>%
drop_na() %>%
count() %>%
ggplot(aes(x = party, y = n)) +
geom_col(aes(fill = party)) +
scale_fill_manual(values = c("darkblue", "green", "indianred")) +
labs(title = "Total Tweets by Party",
"Democrats tweet the most",
x = "Party",
y = "") +
theme_clean()
party_count_plot
ggsave(plot = party_count_plot, "plots/party_summary_plot.png")
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, n), y = n)) +
geom_col(aes(fill = party)) +
scale_fill_manual(values = c("navyblue", "indianred")) +
coord_flip() +
theme_clean()
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, n), y = n)) +
geom_col(aes(fill = party)) +
scale_fill_manual(values = c("navyblue", "indianred")) +
coord_flip() +
labs(x = "Name", y = "Total Tweets",
title = "Total Amount of Tweets") +
theme_clean()
name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, n), y = n)) +
geom_col(aes(fill = party)) +
scale_fill_manual(values = c("navyblue", "indianred")) +
coord_flip() +
labs(x = "Name", y = "Total Tweets",
title = "Total Amount of Tweets",
subtitle = "Top 20 tweeters") +
theme_clean()
tweets_name_plot <- name_top %>%
arrange(desc(n)) %>%
drop_na() %>%
ggplot(aes(x = reorder(name, n), y = n)) +
geom_col(aes(fill = party)) +
scale_fill_manual(values = c("navyblue", "indianred")) +
coord_flip() +
labs(x = "Name", y = "Total Tweets",
title = "Total Amount of Tweets",
subtitle = "Top 20 tweeters") +
theme_clean()
ggsave(plot = tweets_name_plot, "plots/tweets_by_name_plot.png")
